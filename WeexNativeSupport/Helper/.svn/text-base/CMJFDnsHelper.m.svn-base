//
//  CMJFDnsHelper.m
//  CMfspay
//
//  Created by fuguoguo on 2018/4/2.
//  Copyright © 2018年 mrchabao. All rights reserved.
//

#import "CMJFDnsHelper.h"

@implementation CMJFDnsHelper

+ (NSArray *)queryAllIpsWithUrl:(NSString *)url{
    NSMutableArray *array = [[NSMutableArray alloc] init];
    [array addObject:[QNResolver systemResolver]];
    [array addObject:[[QNResolver alloc] initWithAddress:@"119.29.29.29"]];
    QNDnsManager *dns = [[QNDnsManager alloc] init:array networkInfo:[QNNetworkInfo normal]];
    NSArray *ips = [dns query:url];
    return ips;
}

+ (NSString *)urlReplaceByIp:(NSString *)urlStr{
    QNDnsManager *dns;
    if([QNDnsManager needHttpDns]){
        NSMutableArray *array = [[NSMutableArray alloc] init];
        [array addObject:[[QNResolver alloc] initWithAddress:@"119.29.29.29"]];
        [array addObject:[QNResolver systemResolver]];
        dns = [[QNDnsManager alloc] init:array networkInfo:[QNNetworkInfo normal]];
    }else{
        NSMutableArray *array = [[NSMutableArray alloc] init];
        [array addObject:[QNResolver systemResolver]];
        [array addObject:[[QNResolver alloc] initWithAddress:@"8.8.8.8"]];
        dns = [[QNDnsManager alloc] init:array networkInfo:[QNNetworkInfo normal]];
    }
    NSURL *u = [[NSURL alloc] initWithString:urlStr];
    NSURL *u2 = [dns queryAndReplaceWithIP:u];
    return [u2 absoluteString];
}

@end
